{namespace fed = Tx_Fed_ViewHelpers}
<f:form class="form-horizontal" controller="Schedule" action="update" name="schedule" object="{schedule}">
    <fieldset>
	<legend>Schedule</legend>
	<div class="control-group">
	    <label class="control-label" for="start">
		<f:translate key="tx_lecoop_domain_model_schedule.start" />*
	    </label>
	    <div class="controls">
		<f:form.textfield class="datepicker" property="start"  value="{schedule.start->f:format.date(format: 'm/d/y')}" />
		<p></p>
	    </div>
	    <label class="control-label" for="end">
		<f:translate key="tx_lecoop_domain_model_schedule.end" />*
	    </label>
	    <div class="controls">
		<f:form.textfield class="datepicker" property="end"  value="{schedule.end->f:format.date(format: 'm/d/y')}" />
		<p></p>
	    </div>
	</div>


	<div class="form-actions">
	    <f:form.hidden name="course" value="{course}" />
	    <f:form.submit class="btn btn-primary" value="Update Schedule" />
	</div>
	<legend>Events</legend>

	<table class="table table-striped table-bordered table-condensed">
	    <thead>
		<tr>
		    <th>#</th>
		    <th>First Event</th>
		    <th>Last Event</th>
		    <th>Duration</th>
		    <th>Repetition</th>
		    <th>Next Event</th>
		    <th># of Events</th>
		    <th>Functions</th>
		</tr>
	    </thead>
	    <tbody>
	    <f:for each="{course.scheduleid.events}" as="event" iteration="it">
		<tr>
		    <td><fed:math expression="{it.index} + 1" /></td>
		    <td>{event.start->f:format.date(format: 'm/d/y H:i')}</td>
		    <td>{event.end->f:format.date(format: 'm/d/y H:i')}</td>
		    <td>{event.length->f:format.date(format: 'H:i')}</td>
		    <td>
		    <f:if condition="{event.steplength} > 0">
			<f:then>{event.steplength} {f:if(condition: '{event.steplength} == 1', then: 'Day', else: 'Days')}</f:then>
			<f:else>none</f:else>
		    </f:if>

		    </td>
		    <td>
		    <f:if condition="{event.nextEvent}">
			<f:then>
			    <f:format.date format="m/d/y H:i">{event.nextEvent}</f:format.date>
			</f:then>
			<f:else>n/a</f:else>
		    </f:if>
		    </td>
		    <td>{event.calcEvents} ({event.calcRemEvents})</td>
		    <td>
			<f:link.action controller="Schedule" action="editEvent" arguments="{course: '{course}', event: '{event}'}">Edit</f:link.action>
			<f:link.action controller="Schedule" action="deleteEvent" arguments="{course: '{course}', event: '{event}'}">Delete</f:link.action>
		    </td>
		</tr>
	    </f:for>

	    <tr>
		<td colspan="8"><f:link.action controller="Schedule" action="newEvent" arguments="{event: '', course: '{course}'}" class="btn btn-primary pull-right">Add Event</f:link.action></td>
	    </tr>

	    </tbody>
	</table>
    </fieldset>
</f:form>